<div class="d-flex justify-content-center" *ngIf="loadingQuerysets">
  <div class="spinner-border" role="status">
    <span class="sr-only">Loading...</span>
  </div>
</div>

<div class="form-group" *ngIf="!loadingQuerysets">
  <label for="queryset-select">
    Select a queryset to introspect
  </label>
  <select
    class="form-control form-control-lg"
    [(ngModel)]="selectedQueryset"
    (ngModelChange)="onQuerysetChange()">

    <option
      *ngFor="let qs of querysets"
      [ngValue]="qs"
      class="has_value">{{ qs.name }}</option>

  </select>
</div>

<section *ngIf="selectedQueryset" class="queryset-detail">
  <div class="d-flex justify-content-center">
    <h2>
      <small class="text-muted">#{{ selectedQueryset.id }} : </small>
      {{ selectedQueryset.name }}
    </h2>
  </div>

  <ngb-accordion #acc="ngbAccordion" activeIds="resultsPanel">
    <ngb-panel id="filtersPanel">
      <ng-template ngbPanelTitle>
        <strong>Filters</strong>
        <span class="badge badge-primary badge-pill">4</span>
      </ng-template>

      <ng-template ngbPanelContent>


        <ul class="list-group">


          <li class="list-group-item-action list-group-item active"
              *ngFor="let filter of filtersResponse">
            <div class="input-group">
              <div class="input-group-prepend">
                <span class="input-group-text">
                  <input type="checkbox" checked="true" [disabled]="filter.readonly" >
                </span>
              </div>
              <div class="input-group-prepend">
                <span class="input-group-text">
                  {{ filter.method }}:
                  <strong>{{ filter.field_verbose }}</strong>
                  ( {{ filter.lookup }} )
                </span>
              </div>
              <input type="text" aria-label="First name" class="form-control" placeholder="From" [disabled]="filter.readonly" [value]="filter.value_0">
              <input type="text" aria-label="Last name" class="form-control" placeholder="To" [disabled]="filter.readonly" [value]="filter.value_1">
            </div>

          </li>
        </ul>

        <hr class="mb-4">

        <div class="row">
          <div class="col-sm">
            <button class="btn btn-secondary btn-lg btn-block" type="submit">Limpar</button>
          </div>
          <div class="col-sm">
            <button class="btn btn-primary btn-lg btn-block" type="submit">Atualizar</button>
          </div>
        </div>

      </ng-template>

    </ngb-panel>
    <ngb-panel id="resultsPanel">
      <ng-template ngbPanelTitle>
        <strong>Results</strong>
        <span class="badge badge-primary badge-pill">30</span>
      </ng-template>

      <ng-template ngbPanelContent>
        <div class="d-flex justify-content-center" *ngIf="loadingQueryset">
          <div class="spinner-border" role="status">
            <span class="sr-only">Loading...</span>
          </div>
        </div>

        <div class="d-flex" *ngIf="!loadingQueryset && querysetResponse">
          <table class="table-responsive table-striped table-hover table-sm">
            <thead>
              <tr>
                <th *ngFor="let field of querysetResponse.fields" scope="col">
                  {{ field['field_verbose'] }}
                </th>
              </tr>
            </thead>
            <tbody>
            <tr *ngFor="let row of querysetResponse.result">
              <td *ngFor="let field of querysetResponse.fields">
                {{ row[field['field']] }}
              </td>
            </tr>
            </tbody>
          </table>
        </div>
      </ng-template>

    </ngb-panel>
  </ngb-accordion>


</section>
